(()=>{var e={};e.id=3690,e.ids=[3690,2888,660],e.modules={7639:e=>{e.exports={grid:"ExpeditionsPage_grid__oAmLC",card:"ExpeditionsPage_card__Y0zyW",inProgress:"ExpeditionsPage_inProgress__y6gTP",readyToClaim:"ExpeditionsPage_readyToClaim__V4xg6",nftImage:"ExpeditionsPage_nftImage__otd_3",cardContent:"ExpeditionsPage_cardContent__SZDWl",timer:"ExpeditionsPage_timer__ZXgIF",select:"ExpeditionsPage_select__c_Jpv",button:"ExpeditionsPage_button__FCPTJ"}},2998:(e,a,t)=>{"use strict";t.r(a),t.d(a,{config:()=>N,default:()=>f,getServerSideProps:()=>S,getStaticPaths:()=>w,getStaticProps:()=>_,reportWebVitals:()=>b,routeModule:()=>I,unstable_getServerProps:()=>k,unstable_getServerSideProps:()=>C,unstable_getStaticParams:()=>E,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>P});var s={};t.r(s),t.d(s,{default:()=>ExpeditionsPage});var n=t(7093),i=t(5244),r=t(1323),d=t(4003),o=t(9597),l=t(997),c=t(6689),x=t(968),m=t.n(x),p=t(1178),h=t(171),u=t(7639),g=t.n(u);let j={mission_1h:{name:"Expedi\xe7\xe3o Curta (1h)",duration:3600,rewardToken:"INSULINE",rewardAmount:.1},mission_4h:{name:"Expedi\xe7\xe3o M\xe9dia (4h)",duration:14400,rewardToken:"INSULINE",rewardAmount:.5},mission_12h:{name:"Expedi\xe7\xe3o Longa (12h)",duration:43200,rewardToken:"INSULINE",rewardAmount:1},mission_24h:{name:"Expedi\xe7\xe3o de Elite (24h)",duration:86400,rewardToken:"INSULINE",rewardAmount:2.2},mission_48h:{name:"Explora\xe7\xe3o Profunda (48h)",duration:172800,rewardToken:"INSULINE",rewardAmount:4.5}};function Countdown({endsAt:e,onComplete:a}){let[t,s]=(0,c.useState)(new Date(e)-new Date);(0,c.useEffect)(()=>{if(t<=0){a();return}let e=setInterval(()=>{s(e=>e-1e3)},1e3);return()=>clearInterval(e)},[t,a]);let n=Math.floor(t/36e5%24),i=Math.floor(t/1e3/60%60),r=Math.floor(t/1e3%60);return l.jsx("span",{children:`${n.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`})}function ExpeditionsPage(){let{userAddress:e,provider:a}=(0,p.U)(),[t,s]=(0,c.useState)([]),[n,i]=(0,c.useState)([]),[r,d]=(0,c.useState)(!0),[o,x]=(0,c.useState)({message:"",type:""}),[u,f]=(0,c.useState)({}),showFeedback=(e,a)=>{x({message:e,type:a}),setTimeout(()=>x({message:"",type:""}),4e3)},fetchData=async e=>{if(e){d(!0);try{let t=await (0,h.F)(e,a);s(t);let n=await fetch(`/api/expeditions/status?wallet=${e}`);if(!n.ok)throw Error("Falha ao buscar expedi\xe7\xf5es.");let r=await n.json();i(r)}catch(e){showFeedback(e.message,"error")}finally{d(!1)}}};(0,c.useEffect)(()=>{e?fetchData(e):d(!1)},[e]);let handleStartExpedition=async(a,t)=>{if(!t){showFeedback("Por favor, selecione uma miss\xe3o.","error");return}f(e=>({...e,[a]:!0}));try{let s=await fetch("/api/expeditions/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userWallet:e,nftId:a,missionType:t})}),n=await s.json();if(!s.ok)throw Error(n.message);showFeedback(n.message,"success"),await fetchData(e)}catch(e){showFeedback(e.message,"error")}finally{f(e=>({...e,[a]:!1}))}},handleClaimReward=async a=>{f(e=>({...e,[a]:!0}));try{let t=await fetch("/api/expeditions/claim",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userWallet:e,expeditionId:a})}),s=await t.json();if(!t.ok)throw Error(s.message);showFeedback(s.message,"success"),await fetchData(e)}catch(e){showFeedback(e.message,"error")}finally{f(e=>({...e,[a]:!1}))}},_=new Set(n.filter(e=>!e.rewardClaimed).map(e=>e.nftId)),w=t.filter(e=>!_.has(e.id||e.tokenId)),S=n.filter(e=>!e.rewardClaimed&&new Date<new Date(e.endsAt)),N=n.filter(e=>!e.rewardClaimed&&new Date>=new Date(e.endsAt));return(0,l.jsxs)("div",{className:g().canvas,children:[l.jsx(m(),{children:l.jsx("title",{children:"Expedi\xe7\xf5es M\xe9dicas - Hospital Fumegator"})}),(0,l.jsxs)("div",{className:g().container,children:[l.jsx("h1",{className:g().title,children:"Expedi\xe7\xf5es M\xe9dicas"}),e?r?l.jsx("p",{className:g().centerText,children:"Carregando dados..."}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("section",{className:g().section,children:[l.jsx("h2",{children:"Em Andamento"}),S.length>0?l.jsx("div",{className:g().grid,children:S.map(a=>(0,l.jsxs)("div",{className:`${g().card} ${g().inProgress}`,children:[l.jsx("img",{src:t.find(e=>(e.id||e.tokenId)===a.nftId)?.image,alt:"NFT",className:g().nftImage}),(0,l.jsxs)("div",{className:g().cardContent,children:[(0,l.jsxs)("p",{children:[l.jsx("strong",{children:"Miss\xe3o:"})," ",j[a.missionType]?.name]}),(0,l.jsxs)("p",{children:[l.jsx("strong",{children:"Recompensa:"})," ",a.rewardAmount," ",a.rewardToken]}),l.jsx("div",{className:g().timer,children:l.jsx(Countdown,{endsAt:a.endsAt,onComplete:()=>fetchData(e)})}),l.jsx("button",{className:g().button,disabled:!0,children:"Em Miss\xe3o..."})]})]},a.id))}):l.jsx("p",{children:"Nenhuma expedi\xe7\xe3o em andamento."})]}),(0,l.jsxs)("section",{className:g().section,children:[l.jsx("h2",{children:"Recompensas para Coletar"}),N.length>0?l.jsx("div",{className:g().grid,children:N.map(e=>(0,l.jsxs)("div",{className:`${g().card} ${g().readyToClaim}`,children:[l.jsx("img",{src:t.find(a=>(a.id||a.tokenId)===e.nftId)?.image,alt:"NFT",className:g().nftImage}),(0,l.jsxs)("div",{className:g().cardContent,children:[l.jsx("p",{children:l.jsx("strong",{children:"Miss\xe3o Conclu\xedda!"})}),(0,l.jsxs)("p",{children:[l.jsx("strong",{children:"Recompensa:"})," ",e.rewardAmount," ",e.rewardToken]}),l.jsx("button",{className:g().button,onClick:()=>handleClaimReward(e.id),disabled:u[e.id],children:u[e.id]?"Coletando...":"Coletar Recompensa"})]})]},e.id))}):l.jsx("p",{children:"Nenhuma recompensa pronta."})]}),(0,l.jsxs)("section",{className:g().section,children:[l.jsx("h2",{children:"NFTs Dispon\xedveis para Expedi\xe7\xe3o"}),w.length>0?l.jsx("div",{className:g().grid,children:w.map(e=>{let a=`${e.id||e.tokenId}_mission`;return(0,l.jsxs)("div",{className:g().card,children:[l.jsx("img",{src:e.image,alt:e.name,className:g().nftImage}),(0,l.jsxs)("div",{className:g().cardContent,children:[l.jsx("p",{children:l.jsx("strong",{children:e.name})}),(0,l.jsxs)("select",{className:g().select,onChange:e=>f(t=>({...t,[a]:e.target.value})),defaultValue:"",children:[l.jsx("option",{value:"",disabled:!0,children:"Selecione uma miss\xe3o"}),Object.keys(j).map(e=>l.jsx("option",{value:e,children:j[e].name},e))]}),l.jsx("button",{className:g().button,onClick:()=>handleStartExpedition(e.id||e.tokenId,u[a]),disabled:u[e.id||e.tokenId]||!u[a],children:u[e.id||e.tokenId]?"Enviando...":"Iniciar Expedi\xe7\xe3o"})]})]},e.id||e.tokenId)})}):l.jsx("p",{children:"Nenhum NFT dispon\xedvel. Eles podem estar em miss\xf5es ou em uso no jogo."})]})]}):l.jsx("p",{className:g().centerText,children:"Por favor, conecte sua carteira no jogo para acessar as expedi\xe7\xf5es."})]}),o.message&&l.jsx("div",{className:`${g().notification} ${g()[o.type]}`,children:o.message})]})}let f=(0,r.l)(s,"default"),_=(0,r.l)(s,"getStaticProps"),w=(0,r.l)(s,"getStaticPaths"),S=(0,r.l)(s,"getServerSideProps"),N=(0,r.l)(s,"config"),b=(0,r.l)(s,"reportWebVitals"),P=(0,r.l)(s,"unstable_getStaticProps"),v=(0,r.l)(s,"unstable_getStaticPaths"),E=(0,r.l)(s,"unstable_getStaticParams"),k=(0,r.l)(s,"unstable_getServerProps"),C=(0,r.l)(s,"unstable_getServerSideProps"),I=new n.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/expeditions",pathname:"/expeditions",bundlePath:"",filename:""},components:{App:o.default,Document:d.default},userland:s})},4003:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>Document});var s=t(997),n=t(6859);function Document(){return(0,s.jsxs)(n.Html,{lang:"pt-BR",children:[s.jsx(n.Head,{children:s.jsx("meta",{name:"google-adsense-account",content:"ca-pub-8822559687614116"})}),(0,s.jsxs)("body",{children:[s.jsx(n.Main,{}),s.jsx(n.NextScript,{})]})]})}},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{"use strict";e.exports=require("next/head")},6689:e=>{"use strict";e.exports=require("react")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},1017:e=>{"use strict";e.exports=require("path")}};var a=require("../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),t=a.X(0,[6859,8450,9597,171],()=>__webpack_exec__(2998));module.exports=t})();