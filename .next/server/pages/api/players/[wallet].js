"use strict";(()=>{var e={};e.id=4983,e.ids=[4983],e.modules={3524:e=>{e.exports=require("@prisma/client")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6459:(e,a,t)=>{t.r(a),t.d(a,{config:()=>u,default:()=>d,routeModule:()=>i});var r={};t.r(r),t.d(r,{default:()=>handler});var s=t(1802),l=t(7153),o=t(6249),n=t(7864);async function handler(e,a){let{wallet:t}=e.query;if(!t)return a.status(400).json({message:"Wallet address is required."});if("GET"===e.method)try{let e=await n.Z.gameState.findUnique({where:{wallet:t}});if(!e)return a.status(404).json({message:"No saved progress found for this wallet."});return a.status(200).json({gameState:e.state})}catch(e){return console.error(`Error loading progress for ${t}:`,e),a.status(500).json({message:"Internal server error while loading progress."})}if("POST"===e.method){let{gameState:r}=e.body;if(!r)return a.status(400).json({message:"GameState data is required."});try{return await n.Z.user.upsert({where:{wallet:t},update:{},create:{wallet:t}}),await n.Z.gameState.upsert({where:{wallet:t},update:{state:r},create:{wallet:t,state:r}}),r.playerStats&&await n.Z.playerStat.upsert({where:{userWallet:t},update:{totalTokensProduced:r.playerStats.totalTokensProduced||0,maxLevelReached:r.playerStats.maxLevelReached||1},create:{userWallet:t,totalTokensProduced:r.playerStats.totalTokensProduced||0,maxLevelReached:r.playerStats.maxLevelReached||1}}),a.status(200).json({message:"Progress saved successfully."})}catch(e){return console.error(`Error saving progress for ${t}:`,e),a.status(500).json({message:"Internal server error while saving progress."})}}a.setHeader("Allow",["GET","POST"]),a.status(405).end(`Method ${e.method} Not Allowed`)}let d=(0,o.l)(r,"default"),u=(0,o.l)(r,"config"),i=new s.PagesAPIRouteModule({definition:{kind:l.x.PAGES_API,page:"/api/players/[wallet]",pathname:"/api/players/[wallet]",bundlePath:"",filename:""},userland:r})},7864:(e,a,t)=>{let r;t.d(a,{Z:()=>l});var s=t(3524);console.log("INICIALIZANDO PRISMA CLIENT. CONECTANDO AO BANCO DE DADOS:",process.env.DATABASE_URL),global.prisma||(global.prisma=new s.PrismaClient),r=global.prisma;let l=r}};var a=require("../../../webpack-api-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),t=a.X(0,[4222],()=>__webpack_exec__(6459));module.exports=t})();