"use strict";(()=>{var e={};e.id=4676,e.ids=[4676],e.modules={3524:e=>{e.exports=require("@prisma/client")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3727:(e,t,r)=>{r.r(t),r.d(t,{config:()=>u,default:()=>l,routeModule:()=>m});var i={};r.r(i),r.d(i,{default:()=>handler});var a=r(1802),n=r(7153),o=r(6249),s=r(7864),d=r(9716);let getMissionConfig=(e="en")=>({mission_1h:{name:(0,d.t)("expedition_short",e),duration:3600,rewardToken:"INSULINE",rewardAmount:.1},mission_4h:{name:(0,d.t)("expedition_medium",e),duration:14400,rewardToken:"INSULINE",rewardAmount:.5},mission_12h:{name:(0,d.t)("expedition_long",e),duration:43200,rewardToken:"INSULINE",rewardAmount:1},mission_24h:{name:(0,d.t)("expedition_elite",e),duration:86400,rewardToken:"INSULINE",rewardAmount:2.2},mission_48h:{name:(0,d.t)("expedition_deep",e),duration:172800,rewardToken:"INSULINE",rewardAmount:4.5}});async function handler(e,t){if("POST"!==e.method)return t.status(405).json({message:"Method Not Allowed"});let{userWallet:r,nftId:i,missionType:a}=e.body,n=getMissionConfig();if(!r||!i||!a||!n[a])return t.status(400).json({message:"Invalid mission data provided."});try{let e=await s.Z.expedition.findFirst({where:{nftId:i,rewardClaimed:!1}});if(e)return t.status(400).json({message:"This Specialist is already on an expedition."});let o=n[a],d=new Date,l=new Date(d.getTime()+1e3*o.duration),u=await s.Z.expedition.create({data:{userWallet:r,nftId:i,missionType:a,startedAt:d,endsAt:l,rewardToken:o.rewardToken,rewardAmount:o.rewardAmount,rewardClaimed:!1}});t.status(200).json({message:"Expedition started successfully!",expedition:u})}catch(e){console.error("Error starting expedition:",e),t.status(500).json({message:"Internal server error."})}}let l=(0,o.l)(i,"default"),u=(0,o.l)(i,"config"),m=new a.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/expeditions/start",pathname:"/api/expeditions/start",bundlePath:"",filename:""},userland:i})},7864:(e,t,r)=>{let i;r.d(t,{Z:()=>n});var a=r(3524);console.log("INICIALIZANDO PRISMA CLIENT. CONECTANDO AO BANCO DE DADOS:",process.env.DATABASE_URL),global.prisma||(global.prisma=new a.PrismaClient),i=global.prisma;let n=i}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222,9716],()=>__webpack_exec__(3727));module.exports=r})();