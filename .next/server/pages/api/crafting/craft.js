"use strict";(()=>{var e={};e.id=8674,e.ids=[8674],e.modules={3524:e=>{e.exports=require("@prisma/client")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},9373:(e,t,r)=>{r.r(t),r.d(t,{config:()=>u,default:()=>c,routeModule:()=>d});var a={};r.r(a),r.d(a,{default:()=>handler});var i=r(1802),n=r(7153),s=r(6249),o=r(7864);let l={accelerator_60m:{ingredients:{INSULINE:500,ZOLGENSMA:250},result:{type:"EQUIPMENT",item:{id:"time_accelerator_60m",name:"Acelerador de Tempo (60 Min)",description:"Acelera TODOS os timers em 2x.",price:0,currency:"SOL",type:"EQUIPMENT",buffName:"timeAccelerator",duration:36e5}}},accelerator_2m:{ingredients:{INSULINE:100,ZOLGENSMA:250},result:{type:"EQUIPMENT",item:{id:"time_accelerator_2m",name:"Acelerador de Tempo (2 Min)",description:"Acelera TODOS os timers em 2x.",price:0,currency:"SOL",type:"EQUIPMENT",buffName:"timeAccelerator",duration:12e4}}},spin_1:{ingredients:{VIDA:10,LUXUTURNA:100},result:{type:"INVENTORY",itemName:"freeSpins",amount:1}},spin_100:{ingredients:{VIDA:1e3,LUXUTURNA:100},result:{type:"INVENTORY",itemName:"freeSpins",amount:100}}};async function handler(e,t){if("POST"!==e.method)return t.status(405).end();let{wallet:r,recipeId:a}=e.body,i=l[a];if(!r||!i)return t.status(400).json({error:"Dados inv\xe1lidos."});try{let e=await o.Z.$transaction(async e=>{let t=await e.gameState.findUnique({where:{wallet:r}});if(!t)throw Error("Usu\xe1rio n\xe3o encontrado.");let a=t.state||{};for(let[e,t]of(a.balances=a.balances||{},a.inventory=a.inventory||{},Object.entries(i.ingredients)))if((a.balances[e]||0)<t)throw Error(`Ingredientes insuficientes. Precisa de ${t} ${e}.`);for(let[e,t]of Object.entries(i.ingredients))a.balances[e]-=t;if("EQUIPMENT"===i.result.type){let e=i.result.item;a.inventory[e.id]={...e,quantity:(a.inventory[e.id]?.quantity||0)+1}}else"INVENTORY"===i.result.type&&(a.freeSpins=(a.freeSpins||0)+i.result.amount);return await e.gameState.update({where:{wallet:r},data:{state:a}}),i.result.item?.name||`${i.result.amount} Giros`});t.status(200).json({success:!0,message:`Voc\xea criou: ${e}!`})}catch(e){t.status(400).json({success:!1,error:e.message})}}let c=(0,s.l)(a,"default"),u=(0,s.l)(a,"config"),d=new i.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/crafting/craft",pathname:"/api/crafting/craft",bundlePath:"",filename:""},userland:a})},7864:(e,t,r)=>{let a;r.d(t,{Z:()=>n});var i=r(3524);console.log("INICIALIZANDO PRISMA CLIENT. CONECTANDO AO BANCO DE DADOS:",process.env.DATABASE_URL),global.prisma||(global.prisma=new i.PrismaClient),a=global.prisma;let n=a}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222],()=>__webpack_exec__(9373));module.exports=r})();