"use strict";(()=>{var e={};e.id=9940,e.ids=[9940],e.modules={3524:e=>{e.exports=require("@prisma/client")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6285:(e,l,i)=>{i.r(l),i.d(l,{config:()=>o,default:()=>u,routeModule:()=>v});var r={};i.r(r),i.d(r,{default:()=>handler});var d=i(1802),a=i(7153),s=i(6249),t=i(7864);let n=[{id:"level_5",requiredLevel:5},{id:"level_18",requiredLevel:18},{id:"level_27",requiredLevel:27},{id:"level_39",requiredLevel:39},{id:"level_45",requiredLevel:45},{id:"level_60",requiredLevel:60},{id:"level_85",requiredLevel:85},{id:"level_97",requiredLevel:97},{id:"level_110",requiredLevel:110},{id:"level_140",requiredLevel:140},{id:"level_183",requiredLevel:183},{id:"level_201",requiredLevel:201},{id:"level_211",requiredLevel:211},{id:"level_223",requiredLevel:223},{id:"level_237",requiredLevel:237},{id:"level_246",requiredLevel:246},{id:"level_250",requiredLevel:250}];async function handler(e,l){if("POST"!==e.method)return l.status(405).json({message:"M\xe9todo n\xe3o permitido."});let{wallet:i,maxLevelReached:r}=e.body;if(!i||!r)return l.status(400).json({message:"Dados insuficientes."});try{let e=await t.Z.userAchievement.findMany({where:{userWallet:i},select:{achievementId:!0}}),d=new Set(e.map(e=>e.achievementId)),a=n.filter(e=>r>=e.requiredLevel&&!d.has(e.id)).map(e=>({userWallet:i,achievementId:e.id}));a.length>0&&(await t.Z.userAchievement.createMany({data:a,skipDuplicates:!0}),console.log(`Usu\xe1rio ${i} desbloqueou ${a.length} nova(s) conquista(s).`)),l.status(200).json({message:"Verifica\xe7\xe3o de conquistas conclu\xedda."})}catch(e){console.error("Erro ao verificar conquistas:",e),l.status(500).json({message:"Erro interno do servidor."})}}let u=(0,s.l)(r,"default"),o=(0,s.l)(r,"config"),v=new d.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/achievements/unlock",pathname:"/api/achievements/unlock",bundlePath:"",filename:""},userland:r})},7864:(e,l,i)=>{let r;i.d(l,{Z:()=>a});var d=i(3524);console.log("INICIALIZANDO PRISMA CLIENT. CONECTANDO AO BANCO DE DADOS:",process.env.DATABASE_URL),global.prisma||(global.prisma=new d.PrismaClient),r=global.prisma;let a=r}};var l=require("../../../webpack-api-runtime.js");l.C(e);var __webpack_exec__=e=>l(l.s=e),i=l.X(0,[4222],()=>__webpack_exec__(6285));module.exports=i})();